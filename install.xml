<?xml version="1.0"?>
<!DOCTYPE modification SYSTEM "http://www.simplemachines.org/xml/modification">
<modification xmlns="http://www.simplemachines.org/xml/modification" xmlns:smf="http://www.simplemachines.org/">
<id>dougiefresh:BetterProfileMenu</id>
<name>Better Profile Menu</name>
<version>1.0</version>

<file name="$sourcedir/Load.php">
	<operation>
		<search position="replace"><![CDATA[$required_files = implode('+', array_merge($templates, array('Modifications')));]]></search>
		<add><![CDATA[$required_files = implode('+', array_merge($templates, array('Modifications', 'Profile')));]]></add>
	</operation>
</file>
<file name="$sourcedir/Subs.php">
	<operation>
		<search position="replace"><![CDATA['profile' => array(
				'title' => $txt['profile'],
				'href' => $scripturl . '?action=profile',
				'show' => $context['allow_edit_profile'],
				'sub_buttons' => array(
					'summary' => array(
						'title' => $txt['summary'],
						'href' => $scripturl . '?action=profile',
						'show' => true,
					),
					'account' => array(
						'title' => $txt['account'],
						'href' => $scripturl . '?action=profile;area=account',
						'show' => allowedTo(array('profile_identity_any', 'profile_identity_own', 'manage_membergroups')),
					),
					'profile' => array(
						'title' => $txt['forumprofile'],
						'href' => $scripturl . '?action=profile;area=forumprofile',
						'show' => allowedTo(array('profile_extra_any', 'profile_extra_own')),
						'is_last' => true,
					),
				),
			),]]></search>
		<add><![CDATA['profile' => array(
				'title' => $txt['profile'],
				'href' => $scripturl . '?action=profile',
				'show' => $context['allow_edit_profile'],
				'sub_buttons' => array(
					'summary' => array(
						'title' => $txt['summary'],
						'href' => $scripturl . '?action=profile',
						'show' => true,
					),
					'account' => array(
						'title' => $txt['account'],
						'href' => $scripturl . '?action=profile;area=account',
						'show' => allowedTo(array('profile_identity_any', 'profile_identity_own', 'manage_membergroups')),
					),
					'profile' => array(
						'title' => $txt['forumprofile'],
						'href' => $scripturl . '?action=profile;area=forumprofile',
						'show' => allowedTo(array('profile_extra_any', 'profile_extra_own')),
					),
					'posts' => array(
						'title' => $txt['showPosts'],
						'href' => $scripturl . '?action=profile;area=showposts',
						'show' => allowedTo(array('profile_extra_any', 'profile_extra_own')),
					),
					'notification' => array(
						'title' => $txt['notification'],
						'href' => $scripturl . '?action=profile;area=notification',
						'show' => allowedTo(array('profile_extra_any', 'profile_extra_own')),
					),
					'ignore' => array(
						'title' => $txt['editBuddyIgnoreLists'],
						'href' => $scripturl . '?action=profile;area=lists;sa=ignore',
						'show' => allowedTo(array('profile_extra_any', 'profile_extra_own')),
						'is_last' => true,
					),
					'theme' => array(
						'title' => $txt['theme'],
						'href' => $scripturl . '?action=profile;area=theme',
						'show' => allowedTo(array('profile_extra_any', 'profile_extra_own')),
					),
				),
			),]]></add>
	</operation>
</file>
</modification>